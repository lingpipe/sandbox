<?xml version="1.0"?>
<project name="lingmed" default="compile" basedir=".">

<!--  
 Build and deploy webapp to Tomcat6 server
 copy (or symlink) tomcat6/lib/catalina-ant.jar 
 to $ANT_HOME/lib
-->

<import file="build_common.xml"/>

<property file="build.properties"/>

<property name="app.name"
          value="genelinkage"/>

<target name="war" 
        depends="jar" 
        description="bundle app into .war file">
  <mkdir dir="build/war"/>
  <copy todir="build/war">
    <fileset dir="web"/>
  </copy>
  <mkdir dir="build/war/WEB-INF/lib"/>
  <copy todir="build/war/WEB-INF/lib">
    <fileset file="${jar}"/>
  </copy>
  <copy file="${lingpipe-jar}"
        todir="build/war/WEB-INF/lib"/>
  <copy file="${lucene-jar}"
        todir="build/war/WEB-INF/lib"/>
  <copy file="lib/log4j-1.2.15.jar"
        todir="build/war/WEB-INF/lib"/>
  <jar destfile="build/${app.name}.war">
    <fileset dir="build/war"/>
  </jar>
</target>

<target name="deploy" 
        depends="war" 
        description="(initial) deploy to Tomcat">
  <taskdef name="deploy"
           classname="org.apache.catalina.ant.DeployTask"/>
  <deploy url="${tomcat.manager.url}"
          username="${tomcat.manager.username}"
          password="${tomcat.manager.password}"
          path="/${app.name}"
          war="build/${app.name}.war"/>
</target>

<target name="undeploy" description="remove app from Tomcat">
  <taskdef name="undeploy"
           classname="org.apache.catalina.ant.UndeployTask"/>
  <undeploy url="${tomcat.manager.url}"
            username="${tomcat.manager.username}"
            password="${tomcat.manager.password}"
            path="/${app.name}"/>
</target>

<target name="redeploy" 
        depends="undeploy,deploy" 
        description="redeploy app to Tomcat" />

</project>
