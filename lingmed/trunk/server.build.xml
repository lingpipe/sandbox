<?xml version="1.0"?>

<project name="lingmed" default="compile" basedir=".">

<property name="version"
          value="1.1"/>

<property name="jar"
          value="lingmed-${version}.jar"/>

<property file="user.properties"/>


<!-- jars and classpaths -->

<property name="lingpipe-jar"
          value="lib/lingpipe-3.7.0.jar"/>
<property name="lucene-jar"
          value="lib/lucene-core-2.4.0.jar"/>


<path id="classpath.common">
  <pathelement location="${jar}"/>
  <pathelement location="${lingpipe-jar}"/>
  <pathelement location="${lucene-jar}"/>
</path>

<path id="classpath.standard">
  <path refid="classpath.common"/>
  <pathelement location="lib/commons-net-1.4.1.jar"/>
  <pathelement location="lib/log4j-1.2.15.jar"/>
  <pathelement location="lib/mysql-connector-java-5.1.5-bin.jar"/>
  <pathelement location="lib/servlet-api-6.0.16.jar"/>
</path>


<!-- rmi properties -->
<property name="absoluteBaseDir" value="/home/lucene"/>
<property name="rmijars"
          value="file:${absoluteBaseDir}/${lucene-jar}"/>
<property name="server.address"
          value="192.168.1.94"/>
<property name="server.port"
          value="1099"/>

<!-- tomcat properties -->
<property name="manager.url"
          value="http://localhost:8080/manager/" />
<property name="manager.username"
          value="admin"/>
<property name="manager.password"
          value="admin"/>
<property name="deploy.path"
          value="C:/java/Tomcat 6.0/webapps" />

<!-- **** dev tasks **** -->


<!-- **** MEDLINE tasks **** -->

<!-- NLM password - e-mail of registered user  -->
<property name="medline.pwd"
          value="carp@aliasi.com"/>

<!-- medline repositiory locations on nlm - not under our control -->
<property name="medline.updates.repository"
          value="/nlmdata/.medlease/gz"/>
<property name="medline.baseline.repository"
          value="/nlmdata/.medleasebaseline/gz"/>

<!-- path where files are downloaded to - under our control -->
<property name="server.medline.dir"
          value="/data1/nlm/medline/dist/2008"/>
<property name="server.medline.baseline.dir"
          value="${server.medline.dir}/baseline"/>
<property name="server.medline.updates.dir"
          value="${server.medline.dir}/updates"/>

<!-- index dir -->
<property name="server.medline.lucene.index.dir"
          value="/data3/lucene/medline_2008"/>

<!-- codec used for indexing and search -->
<property name="medline.codec.class"
          value="com.aliasi.lingmed.medline.SearchableMedlineCodec"/>


<target name="serverDownloadBaseline"
        description="download update files from NLM" >
  <java classname="com.aliasi.lingmed.medline.DownloadMedline"
        maxMemory="800M"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-domain=ftp.nlm.nih.gov"/>
    <arg value="-user=anonymous"/>
    <arg value="-password=${medline.pwd}"/>
    <arg value="-repositoryPath=${medline.baseline.repository}"/>
    <arg value="-targetDir=${server.medline.baseline.dir}"/>
    <arg value="-maxTries=3"/>
    <arg value="-sleep=60"/>
    <arg value="-strict=false"/>
  </java>
</target>

<target name="serverDownloadUpdates"
        description="download update files from NLM" >
  <java classname="com.aliasi.lingmed.medline.DownloadMedline"
        maxMemory="800M"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-domain=ftp.nlm.nih.gov"/>
    <arg value="-user=anonymous"/>
    <arg value="-password=${medline.pwd}"/>
    <arg value="-repositoryPath=${medline.updates.repository}"/>
    <arg value="-targetDir=${server.medline.updates.dir}"/>
    <arg value="-maxTries=3"/>
    <arg value="-sleep=60"/>
    <arg value="-strict=false"/>
  </java>
</target>

<target name="serverIndexBaseline"
        description="create Lucene MEDLINE Index" >
  <java classname="com.aliasi.lingmed.medline.IndexMedline"
        maxMemory="4G"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-index=${server.medline.lucene.index.dir}"/>
    <arg value="-distDir=${server.medline.baseline.dir}"/>
    <arg value="-distType=baseline"/>
    <arg value="-codec=${medline.codec.class}"/>
  </java>
</target>

<target name="serverIndexUpdates"
        description="add updates to Lucene MEDLINE Index" >
  <java classname="com.aliasi.lingmed.medline.IndexMedline"
        maxMemory="4G"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-index=${server.medline.lucene.index.dir}"/>
    <arg value="-distDir=${server.medline.updates.dir}"/>
    <arg value="-distType=updates"/>
    <arg value="-codec=${medline.codec.class}"/>
  </java>
</target>

<target name="serverRmiMedline"
        description="rmi MEDLINE search" >
  <java classname="com.aliasi.lingmed.server.SearchService"
        maxMemory="512M"
        fork="true">
    <classpath refid="classpath.standard"/>
    <jvmarg value="-Djava.rmi.server.codebase=${rmijars}"/>
    <jvmarg value="-Djava.rmi.server.hostname=${server.address}"/>
    <arg value="-port=1099"/>
    <arg value="-service=medline"/>
    <arg value="-index=${server.medline.lucene.index.dir}"/>
  </java>
</target>

<!-- **** Entrez Gene tasks **** -->

<property name="server.entrezgene.lucene.index.dir"
          value="/data2/lucene/entrezgene"/>
<property name="server.entrezgene.dist.file"
          value="/data1/nlm/entrezgene/Homo_sapiens.xml"/>

<target name="indexEntrezGene"
        description="create Lucene EntrezGene index"
        depends="jar">
  <java classname="com.aliasi.lingmed.entrezgene.IndexEntrezGene"
        maxMemory="800M"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-index=${entrezgene.lucene.index.dir}"/>
    <arg value="-distFile=${entrezgene.dist.file}"/>
  </java>
</target>

<target name="serverIndexEntrezGene"
        description="create Lucene EntrezGene index" >
  <java classname="com.aliasi.lingmed.entrezgene.IndexEntrezGene"
        maxMemory="4G"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-index=${server.entrezgene.lucene.index.dir}"/>
    <arg value="-distFile=${server.entrezgene.dist.file}"/>
  </java>
</target>

<target name="serverRmiEntrezGene"
        description="start rmi EntrezGene search server" >
  <java classname="com.aliasi.lingmed.server.SearchService"
        maxMemory="512M"
        fork="true">
    <classpath refid="classpath.standard"/>
    <jvmarg value="-Djava.rmi.server.codebase=${rmijars}"/>
    <jvmarg value="-Djava.rmi.server.hostname=${server.address}"/>
    <arg value="-port=1099"/>
    <arg value="-service=entrezgene"/>
    <arg value="-index=${server.entrezgene.lucene.index.dir}"/>
  </java>
</target>

</project>
