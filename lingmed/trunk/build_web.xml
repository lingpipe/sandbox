<?xml version="1.0"?>
<project name="lingmed" default="compile" basedir=".">

<property file="build.lingmed.properties"/>

<import file="build_common.xml"/>

<!--
     for deploy and undeploy targets
     copy Tomcat6.0/server/lib/catalina-ant.jar
          to $ANT_HOME/lib/

     then open URL: ${manager.url}/${app.name}/url-pattern
     where url-pattern is defined in web/WEB-INF/web.xml
     e.g. manager.url= http://localhost:8080/manager/
          app.name = lingpipe-demo
          url-pattern = /helloWorld
          URL = http://localhost:8080/manager/lingpipe-demo/helloWorld
 -->

<property name="app.name"
          value="genelinkage"/>

<target name="war" depends="jar" description="bundle app into .war file">
  <mkdir dir="build/war"/>
  <copy todir="build/war">
    <fileset dir="web"/>
  </copy>
  <mkdir dir="build/war/WEB-INF/lib"/>
  <copy todir="build/war/WEB-INF/lib">
    <fileset file="${jar}"/>
  </copy>
  <copy file="${lingpipe-jar}"
        todir="build/war/WEB-INF/lib"/>
  <copy file="${lucene-jar}"
        todir="build/war/WEB-INF/lib"/>
  <jar destfile="build/${app.name}.war">
    <fileset dir="build/war"/>
  </jar>
</target>

<taskdef name="stop"
         classname="org.apache.catalina.ant.StopTask"/>

<taskdef name="start"
         classname="org.apache.catalina.ant.StartTask"/>


<target name="deploy" depends="war" description="(initial) deploy to Tomcat">
  <taskdef name="deploy"
           classname="org.apache.catalina.ant.DeployTask"/>
  <deploy url="${tomcat.manager.url}"
          username="${tomcat.manager.username}"
          password="${tomcat.manager.password}"
          path="/${app.name}"
          war="build/${app.name}.war"/>
</target>

<target name="undeploy" description="remove app from Tomcat">
  <taskdef name="undeploy"
           classname="org.apache.catalina.ant.UndeployTask"/>
  <undeploy url="${tomcat.manager.url}"
            username="${tomcat.manager.username}"
            password="${tomcat.manager.password}"
            path="/${app.name}"/>
</target>

<target name="redeploy" 
        depends="undeploy,deploy" 
        description="redeploy app to Tomcat" />

</project>
