<?xml version="1.0"?>
<project name="lingmed" default="compile" basedir=".">

<property name="mxMem" value="4G" />

<import file="build_common.xml"/>

<property file="build.properties"/>

<property name="lingblast.dir"
          value="/data/lingblast"/>

<property name="dictionary"
          value="${lingblast.dir}/exactDictEntrezGene"/>

<property name="model.dir"
          value="${lingblast.dir}/models"/>

<property name="lucene.dir"
          value="/data/lucene"/>

<property name="medline.lucene.index"
          value="${lucene.dir}/medline2009"/>

<property name="entrezgene.lucene.index"
          value="/data/lucene/allEntrezGene"/>

<!-- **** LingBlast, GeneLinkage **** -->
<target name="buildDict"
        description="compile exact match dictionary over all aliases in entrezgene"
        depends="jar">
  <java classname="com.aliasi.lingmed.lingblast.DictionaryBuilder"
        maxMemory="${mxMem}"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-host=localhost"/>
    <arg value="-dictFile=${dictionary}"/>
    <arg value="-medline=${medline.lucene.index}"/>
    <arg value="-entrezgene=${entrezgene.lucene.index}"/>
    <arg value="-maxPubmedHitsPerAlias=5000"/>
    <arg value="-genHtml=true"/>
    <arg value="-allowedNames=/data/lingblast/hifreq_names.txt"/>
  </java>
</target>

<target name="compileModels"
        description="compile per-gene language model"
        depends="jar">
  <java classname="com.aliasi.lingmed.lingblast.ModelCompiler"
        maxMemory="${mxMem}"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-host=localhost"/>
    <arg value="-medline=${medline.lucene.index}"/>
    <arg value="-entrezgene=${entrezgene.lucene.index}"/>
    <arg value="-modelDir=${model.dir}"/>
    <arg value="-genHtml=true"/>
  </java>
</target>

<target name="lingblast"
        description="run lingblast over pubmed repository"
        depends="jar">
  <java classname="com.aliasi.lingmed.lingblast.LingBlastMedline"
        maxMemory="${mxMem}"
        fork="true">
    <classpath refid="classpath.standard"/>
    <arg value="-host=localhost"/>
    <arg value="-dictionary=${dictionary}"/>
    <arg value="-medline=${medline.lucene.index}"/>
    <arg value="-modelDir=${model.dir}"/>
    <arg value="-sqlDir=/data/genelinkage/sql"/>
    <arg value="-genomicsThreshold=100"/>
  </java>
</target>



<!-- build.properties defines mysql database properties -->
<!-- mysqlHost, mysqlPort, mysql.gl.user, mysql.gl.passwd -->
<property name="mysqlBaseURL"
          value="jdbc:mysql://${mysqlHost}:${mysqlPort}"/>

<target name="gene-articles"
        description="generate html from genelinkage db"
        depends="jar">
  <java classname="com.aliasi.lingmed.genelinkage.NBestArticles"
        fork="true">
    <classpath>
      <path refid="classpath.standalone.db"/>
    </classpath>
<!--    <sysproperty 
         key="java.naming.factory.initial"
         value="javax.naming.InitialContext"/> -->
    <arg value="-geneIds=test_geneIds.txt"/>
    <arg value="-maxArticles=500"/>
    <arg value="-host=localhost"/>
    <arg value="-medline=${medline.lucene.index}"/>
    <arg value="-entrezgene=${entrezgene.lucene.index}"/>
    <arg value="-dbUrl=${mysqlBaseURL}/gene_linkage"/>
    <arg value="-dbName=gene_linkage"/>
    <arg value="-dbUserName=${mysql.gl.user}"/>
    <arg value="-dbUserPassword=${mysql.gl.passwd}"/>
  </java>
</target>

</project>
